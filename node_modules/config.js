/**
 * Load modules
 */

// Global
var logger = require('logger');



/**
 * Variables
 */

var config;



/**
 * Load the config from the database
 */

var loadFromDB = function (omsApplication, callback) {
	logger.info('[Config] Start loading config from database for application ' + omsApplication);
	var Dao = require('db').Dao;
	var dao = new Dao('config');
	dao.findOne({name: omsApplication}, function (result) {
		// If no config found
		if (result === undefined || result === null) {
			logger.error('[Config] Unable to load config from database for application ' + omsApplication)
			throw 'Unable to load config from database for application ' + omsApplication;
		}
		// Delete unnecessary properties
		delete result._id;
		delete result.name;
		// Copy properties
		config = result;
		// Done
		logger.info('[Config] Config loaded from database');
		if (callback) callback();
	});
}



/**
 * Get a config value, undefined else.
 */

var get = function (key) {
	return config[key];
};



/**
 * Exports
 */

exports.get = get;
exports.loadFromDB = loadFromDB;